= Contribution workflow
:description: Explains the basic contribution workflows.
:page-layout: progress
:page-progress_bar: progress_bar_simple-contribution_workflow.svg
:tour_guide_small:

//tag::body[]

include::tour_guide:partial$_attributes.adoc[]

include::compendium:partial$issue_labels.adoc[]

== Overview 
Developing content for ASAM standards is focused around the concept of xref:tour_guide:contribution/contribute_with_issues.adoc[contributing with issues]. +
The following sections describe this workflow in more detail.
Note that the workflow starts when an issue is assigned to someone.
Whether the issue is created with an assignee or assigned by someone from the project later is irrelevant. +
How an unassigned issue is assigned and by whom is out-of-scope for this workflow.
The project group may define their own workflow and responsibilities for that.


.Workflow stages
[mermaid]
....
graph LR
START(( START ))
--Issue assigned--> ANALYSIS
ANALYSIS --Duplicate-->CLOSED
ANALYSIS --Rejected/Won't fix-->CLOSED
ANALYSIS --Analyzed--> IMPLEMENTATION
IMPLEMENTATION --Done--> REVIEW
IMPLEMENTATION --Analysis required--> ANALYSIS
REVIEW --Review NOK--> IMPLEMENTATION
REVIEW --Review OK--> INTEGRATION
INTEGRATION --Done--> MERGE
INTEGRATION --Rejected/Won't fix-->CLOSED
MERGE --Review NOK--> INTEGRATION
MERGE --Review OK--> CLOSED;
style START color:#000000, fill:#000000
....

Each stage is described in more detail in the sections below.
The role listed at the top of each section is the one responsible for it.

// You may also want to check out ASAM's xref:labels.adoc[**use of labels**].

---

[tabs]
====
Analysis::
+
--
[horizontal]
Who:: Assignee
Steps::
. Assign the label {requiresClarification-label} to indicate this issue is being looked at and discussed.
. Coordinate and drive the preparation of a proposal for addressing the issue.
Do this either directly via comments or in further meetings, adding the results to the comments later.
. If the analysis shows the issue is a duplicate to another issue in the same project:
.. Assign the label {isStatusDuplicate-label} and assign the Subgroup Lead 
// {role-sg-lead}
.. The SG Lead reviews the issue and either closes it (if it is a duplicate) or changes the status back to {requiresClarification-label} and the assignee back to the original issue assignee
Transitions:: 
Issue is a duplicate::: -> CLOSED (Duplicate)
Issue is rejected::: -> CLOSED (Rejected)
Issue can or will not be fixed::: -> CLOSED (Won't fix)
Issue analysis complete::: -> IMPLEMENTATION (Analyzed)
Tips::
* If analysis shows an issue to contain too many steps, create linked related issues to split the topic up further for faster content implementation
--
Implementation::
+
--
[horizontal]
Who:: Assignee
Steps::
. Once a proposal is ready to be implemented, follow the steps as layed out in xref:tour_guide:contribution/issue_implementation.adoc[]
. Implement the topics of that issue
. Review implementation progress of issue with the Subgroup Lead and the other project participants in Subgroup meetings
// {role-sg-lead}  {role-project-participant} 
. Once the group agrees that the feature is complete, request a review by the whole project
Transitions:: 
Issue requires more analysis or should be rejected::: -> ANALYSIS (Analysis required)
Issue is completely implemented::: -> REVIEW (Done)
--
Review::
+
--
The Review stage consists of the **Internal review** and the **Change Control Board review**

**Internal review** +
[horizontal]
Who:: All project participants
// {role-project-participant}
Steps::
. Submit feedback on the changes directly in the Merge/Pull Request
* General feedback: Submit a comment on the Merge/Pull Request
* Content specific feedback: Start a review in the changes tab of the Merge/Pull Request
+
NOTE: To start a review, write a comment on a diff as normal under the 'Changes' tab in a Merge/Pull Request and then select 'Start a review'. +
Click https://docs.gitlab.com/ee/user/discussions/#starting-a-review[here^] for more information.
+
. If the review feedback requires further development work, the process restarts from the **Implementation** stage
Tips::
* Technical discussion happen in comments


// .A demo of a review
// image::gitlab/ReviewExample.gif[]

**Change Control Board review** +
[horizontal]
Who:: CCB
Steps::
. If there are no unresolved comments or threads after two weeks, the CCB ends the review
. The Merge/Pull Request is assigned to the Service Provider for **Integration**
Transitions:: 
Implementation insufficient::: -> IMPLEMENTATION (Review NOK)
Implementation accepted::: -> INTEGRATION (Review OK)
--
Integration::
+
--
[horizontal]
Who:: Service Provider
// {role-service-provider}
Steps::
. The Service Provider changes the status label to {requiresDocumentationWork-label}
. The Service Provider refines the content in the Merge/Pull Request
.. The content is adjusted to adhere to ASAM style and writing conventions
// .. The content is adjusted to adhere to xref:compendium:Editorial_guide.adoc[ASAM style and writing conventions]
.. General editorial rewrites to ensure homogeneity of content
+
IMPORTANT: Questions on content should be addressed to the original issue assignee who will be responsible for ensuring a satisfactory resolution.
In the case that questions lead to significant changes to the content, the MR is reopened for review on resolution.
+
. On completion of the integration:
.. Set the status label of the Merge/Pull Request to {requiresCCBReview-label}
* Set to squash commits with https://www.tutorialspoint.com/what-is-a-fast-forward-merge-in-git[fast-forward merging^] (default).
// * Squash commit message MUST adhere to the xref:compendium:Guidelines/repo-commit_conventions.adoc[**Commit Message Conventions**]
Transitions:: 
Issue is rejected::: -> CLOSED (Rejected)
Issue can or will not be fixed::: -> CLOSED (Won't fix)
Integration complete::: -> MERGE (Done)
--
Merge::
+
--
[horizontal]
Who:: CCB
Steps::
. CCB performs a final review of the integrated content
* Is the original content still correctly represented?
* Are all guidelines & conventions maintained?
* Are all discussions resolved?
* Does it have a https://medium.com/@catalinaturlea/clean-git-history-a-step-by-step-guide-eefc0ad8696d[clear commit history^]?
// * Does it have a https://medium.com/@catalinaturlea/clean-git-history-a-step-by-step-guide-eefc0ad8696d[clear commit history^] that adheres to the xref:compendium:Guidelines/repo-commit_conventions.adoc[]?
. If the review is not passed, return to **Integration**
. If the review is passed and the CCB can merge, the CCB merges the Merge/Pull Request back to the trunk
.. The CCB removes the status label and closes the linked issue
. If the review is passed but the CCB may not merge, the CCB changes the status label to {requiresMerge-label}
Tips::
- Use a https://help.github.com/articles/using-pull-requests/[pull request^] for code reviews.
- Delete local and remote feature branches after merging.
Transitions:: 
Integration insufficient::: -> INTEGRATION (Review NOK)
Integration accepted::: -> CLOSED (Review OK)
--
====

//end::body[]
